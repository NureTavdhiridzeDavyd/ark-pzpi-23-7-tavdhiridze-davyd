

МІНІСТЕРСТВО ОСВІТИ І НАУКИ УКРАЇНИ ХАРКІВСЬКИЙ НАЦІОНАЛЬНИЙ УНІВЕРСИТЕТ РАДІОЕЛЕКТРОНІКИ


Кафедра «Програмної інженерії»





ЗВІТ
з лабораторної роботи 2
з дисципліни «Аналіз та рефакторінг коду»
на тему «Розробка бази даних для серверної частини системи та прикладного програмного інтерфейсу (API).»



Виконав:
ст. гр. ПЗПІ-23-7
Тавдгірідзе Д.Д.


Перевірив: Викладач Дашенков Д.С.





Харків 2025



1 БУДОВА ПРОГРАМНОЇ СИСТЕМИ

1.1 Архітектурні рішення для серверної частини системи

     Серверна частина системи HiveTrack розробляється на основі Node.js, що забезпечує високу продуктивність, просту масштабованість та ефективну обробку великої кількості одночасних запитів. Для взаємодії з реляційною базою даних використовується JS-ORM, що дозволяє гнучко виконувати SQL-запити та мінімізувати накладні витрати.
     Мова реалізації — JavaScript, яка дозволяє швидко створювати чітку бізнес-логіку та легко інтегрувати її з клієнтськими технологіями.
     Для авторизації та захисту даних застосовується JWT, що дає змогу безпечно передавати токени та керувати правами доступу учнів, інструкторів і адміністраторів автошкіл.
     Сховище даних — MySQL, вибір якого зумовлений його надійністю, підтримкою складних запитів, високою продуктивністю та наявністю інструментів для аналізу даних, що є важливим для реалізації аналітичних модулів системи HiveTrack.
     Клієнтська частина створюється за допомогою React, HTML, CSS та JavaScript. Для побудови графіків використовується D3.js, що дає змогу візуалізувати результати тестів, прогрес учнів та аналітичні дані.
     Хостинг та CI/CD реалізовано через DigitalOcean та GitHub Actions, що дозволяє забезпечити стабільну роботу серверної частини, регулярні оновлення та автоматичний деплоймент.
1.2 Моделі, що використовуються в системі

   У системі HiveTrack використовується набір предметних моделей, які відображають основні об’єкти навчального процесу автошколи: користувачів, заняття, тести, журнали, розклади й аналітику. Саме ці моделі зберігаються в базі даних MySQL і використовуються бізнес-логікою сервера для реалізації функцій журналів, тестів, практичних виїздів, сповіщень та звітів.
   Базовим елементом є модель User. Кожен користувач має унікальний профіль із полями: ПІБ, контактні дані, роль у системі (учень, інструктор, адміністратор автошколи), статус активності та облікові дані для входу. Роль визначає доступ до інших моделей: учні бачать свій прогрес і розклад, інструктори працюють із журналами та практикою, а адміністратори керують групами, користувачами й аналітикою.
   Навчальний процес організовано через моделі Group та Lesson. Група об’єднує учнів і пов’язується з одним або декількома інструкторами. Теоретичні заняття описуються моделлю TheoryLesson (дата, тема, пов’язана група, викладач), а практичні виїзди — моделлю PracticeSession (інструктор, учень, автомобіль, маршрут, тривалість, оцінка). Для фіксації присутності та успішності існують моделі AttendanceRecord та LessonGrade, що зберігають, чи був учень на занятті, які оцінки отримав і які коментарі залишив викладач. Це утворює електронний журнал теорії та практики, який є одним з ключових компонентів системи.
   Окремий блок моделей відповідає за тестування ПДР. Модель Test описує конкретний набір запитань (режим тренування або іспиту), Question та AnswerOption зберігають формулювання запитань і варіанти відповідей, а TestAttempt фіксує спробу проходження тесту конкретним учнем: час початку й завершення, кількість правильних відповідей, список зроблених помилок. Ці дані використовуються аналітичним модулем для побудови графіків прогресу й виявлення типових помилок.
   Для підтримки розкладів передбачена модель ScheduleEntry, яка пов’язує групи, теоретичні заняття, практичні виїзди та часові слоти. Вона використовується як у вебверсії для адміністраторів і викладачів, так і в мобільному застосунку для учнів та інструкторів, де відображається особистий календар занять. На основі цих даних працює система бронювання практичних виїздів і модуль нагадувань.
   Моделі Notification та ProgressMetric забезпечують сервісні можливості платформи. Notification описує сповіщення (тип події, текст, отримувач, канал доставки — мобільний push або email), а ProgressMetric зберігає агреговані показники успішності: середні бали по темах, відсоток виконаних тестів, прогнозовану готовність до іспиту. Ці моделі використовуються в аналітичному модулі та кабінеті адміністратора для побудови графіків і зведених звітів щодо учнів, груп і всієї автошколи.
   У сукупності зазначені моделі утворюють цілісну предметну область системи HiveTrack і дозволяють відстежувати повний шлях учня — від першого заняття та перших тестів до фінальної готовності до внутрішнього й державного іспиту.


2 UML ДІАГРАМА ПРЕЦЕДЕНТІВ ДЛЯ СЕРВЕРНОЇ ЧАСТИНИ СИСТЕМИ
2.1 UML діаграма

2.2 Опис діаграми
	Серверна частина системи HiveTrack надає набір REST-сервісів, через які взаємодіють основні актори: Учень, Інструктор, Адміністратор автошколи та технічний Системний адміністратор. Додатковим (зовнішнім) актором виступає Email-сервіс, який використовується для надсилання сповіщень і нагадувань.
	Учень взаємодіє із сервером для реєстрації та авторизації в системі, перегляду особистого профілю, розкладу занять, результатів тестів і загального прогресу, а також для проходження онлайн-тестів ПДР. Через ті самі REST-ендпоінти він отримує доступ до історії відвідуваності, практичних виїздів і сповіщень, що повертаються сервером на основі даних із бази.
	Інструктор використовує серверну частину для роботи з електронними журналами теорії та практики: відмічає присутність учнів, виставляє оцінки за заняття та практичні виїзди, залишає коментарі, формує зведену інформацію по своїй групі. Також він може переглядати розклад, планувати практичні заняття й аналізувати динаміку результатів своїх учнів.
	Адміністратор автошколи відповідає за управління довідниками та глобальними налаштуваннями: створення й редагування груп, призначення інструкторів, управління обліковими записами користувачів, налаштування розкладу, запуск формування звітів по групах і всій автошколі. Через серверну частину він отримує доступ до аналітичних даних, узагальнених статистик і журналу аудиту дій у системі. Системний адміністратор додатково має можливість переглядати технічний журнал подій та виконувати сервісні операції (наприклад, блокування облікових записів або перегляд помилок інтеграцій). Email-сервіс виступає зовнішнім актором, якому сервер надсилає запити на відправлення листів (підтвердження реєстрації, нагадування про заняття, сповіщення про результати тестів тощо).



3 ER ДІАГРАМА

3.1 ER діаграма бази даних

	У  ER-діаграмі системи HiveTrack центральною сутністю є таблиця «Користувачі». У ній зберігається інформація про всіх користувачів платформи: учнів, інструкторів та адміністраторів. Для кожного користувача фіксуються ПІБ, email, роль у системі, хеш пароля та ознака активності облікового запису. Саме з цієї таблиці починається більшість зв’язків, оскільки всі інші об’єкти (зарахування, заняття, спроби тестів) так чи інакше належать конкретним користувачам.
	Навчальний процес організовано через сутність «Групи», яка об’єднує учнів, що навчаються разом. Зв’язок між користувачами та групами реалізовано через проміжну таблицю «Зарахування». Вона містить посилання на користувача та групу, дату зарахування та статус (активний / завершив). Такий підхід дозволяє одному учню бути в кількох групах (наприклад, при переході на інший потік), а також дає змогу зберігати історію навчання.
	Заняття в системі описуються таблицею «Заняття», де для кожного запису вказано групу, викладача, тип заняття (теорія чи практика), тему та дату й час проведення. Кожна група має багато занять, а інструктор може проводити заняття для різних груп. Фактична присутність учнів на занятті фіксується в таблиці «Відвідуваність», яка пов’язує конкретне заняття з конкретним учнем і зберігає статус (присутній, відсутній, запізнився) та коментар викладача. Таким чином формується електронний журнал, що дозволяє аналізувати дисципліну й відвідуваність.
	Окремий блок діаграми відповідає за тестування правил дорожнього руху. Таблиця «Тести» описує доступні тести з назвою, режимом (тренувальний чи іспитовий) та лімітом часу. Коли учень проходить тест, створюється запис у таблиці «Спроби тесту», який посилається і на тест, і на користувача-учня. Тут зберігаються час початку та завершення спроби, кількість правильних відповідей і підсумковий результат. Це дозволяє обліковувати всі спроби тестування для подальшого аналізу прогресу, формування звітів та прогнозування готовності до іспиту. У сукупності ці сутності забезпечують базову, але повністю робочу модель даних для підтримки ключових функцій HiveTrack.

4БАЗА ДАНИХ ПРОГРАМНОЇ СИСТЕМИ

4.1 Таблиці бази даних
	У програмній системі HiveTrack використовується реляційна база даних, що реалізована на основі СУБД MySQL. Такий вибір обумовлений необхідністю забезпечити надійну транзакційну обробку даних, підтримку складних запитів для аналітики, а також можливість масштабування при збільшенні кількості автошкіл та користувачів. Доступ до бази даних здійснюється з серверної частини через шар доступу до даних (DAL), який інкапсулює виконання SQL-запитів і гарантує цілісність бізнес-правил.
	Логічна структура бази даних відповідає побудованій ER-діаграмі та включає основні таблиці: Users (користувачі), Groups (навчальні групи), Enrollment (зарахування учнів до груп), Lessons (заняття), Attendance (відвідуваність), Tests (тести) та TestAttempts (спроби проходження тестів). Кожна таблиця має первинний ключ (Id), який однозначно ідентифікує запис, та зовнішні ключі, що реалізують зв’язки між сутностями (наприклад, Enrollment.UserId посилається на Users.Id, а Lessons.GroupId — на Groups.Id). Це дозволяє однозначно пов’язувати учнів з групами, заняттями, відвідуваністю та результатами тестів.
	Таблиця Users зберігає облікові дані та ролі користувачів, у тому числі учнів, інструкторів і адміністраторів. Таблиці Groups та Enrollment реалізують механізм формування навчальних груп та історію зарахувань. Заняття описуються у таблиці Lessons, де для кожного запису фіксуються група, викладач, тип заняття (теорія чи практика), тема й дата проведення. Фактична присутність на заняттях фіксується в таблиці Attendance, яка містить посилання на урок та учня, а також статус відвідування та коментар викладача. Таким чином, база даних підтримує повноцінний електронний журнал теоретичних і практичних занять.
	Модуль тестування ПДР ґрунтується на таблицях Tests та TestAttempts. У таблиці Tests зберігається загальна інформація про тести (назва, режим, ліміт часу), а в таблиці TestAttempts — окремі спроби проходження тесту конкретними учнями з фіксацією часу початку й завершення, кількості правильних відповідей та підсумкового результату. На основі цих даних формуються звіти про успішність і динаміку підготовки до іспиту.
	Для забезпечення продуктивності в базі даних створюються індекси за найчастіше використовуваними полями пошуку: ідентифікаторами користувачів та груп, датами занять, посиланнями на тести тощо. Обмеження цілісності (PRIMARY KEY, FOREIGN KEY, NOT NULL) запобігають появі «висячих» записів і гарантують узгодженість даних навіть при паралельному доступі до системи великої кількості користувачів. У сукупності це робить базу даних надійним фундаментом для всіх функціональних модулів HiveTrack.

5 ДІАГРАМА СТРУКТУРИ БД
5.1 Діаграма бази даних

Рисунок 5.1 - Схема бази даних
     База даних складається з кількох основних сутностей, які описують користувачів, навчальні групи, заняття, відвідуваність, тести з ПДР, спроби проходження тестів, сповіщення та агреговані показники прогресу. Центральною таблицею є Users, яка пов’язує більшість інших таблиць через зовнішні ключі та використовується як джерело інформації про всіх учасників навчального процесу (учнів, інструкторів, адміністраторів) (Див. додаток А.1).
     Кожен користувач зберігається в таблиці Users, де фіксується його повне ім’я, електронна пошта, номер телефону, роль у системі (Student, Instructor, Admin), хеш пароля, статус активності та дата створення запису. З користувачем можуть бути пов’язані декілька сутностей: зарахування до груп, проведені або відвідані заняття, спроби проходження тестів, отримані сповіщення та агреговані метрики прогресу. Таким чином, Users виступає базовою сутністю, від якої відштовхується більшість бізнес-процесів системи (Див. додаток А.1).
     Таблиця Groups зберігає інформацію про навчальні групи автошколи: назву, категорію (наприклад, В), дату початку та завершення навчання. Зв’язок між учнями та групами реалізовано через таблицю Enrollments, яка відображає відношення «багато до багатьох» між Users та Groups. У ній фіксуються користувач, група, до якої він зарахований, дата зарахування та статус (Active, Finished, Withdrawn), що дозволяє зберігати історію навчання кожного учня (Див. додаток А.1).
     Хід навчального процесу описується таблицею Lessons, у якій зберігаються заняття, прив’язані до конкретної групи та інструктора. Для кожного заняття задаються тип (теоретичне або практичне), тема та дата й час проведення. Фактична присутність учнів на заняттях фіксується в таблиці Attendance, де кожен запис містить посилання на урок (LessonId), учня (StudentId), статус відвідування (Present, Absent, Late) та коментар викладача. Таким чином реалізовано електронний журнал відвідуваності, який дозволяє аналізувати дисципліну та активність учнів (Див. додаток А.1).
     Модуль тестування ПДР реалізується за допомогою групи таблиць Tests, Questions, AnswerOptions, TestAttempts та TestAnswers. Таблиця Tests містить загальну інформацію про тести: назву, режим (Training або Exam) та ліміт часу на проходження. Таблиця Questions зберігає запитання, прив’язані до конкретного тесту, а AnswerOptions — варіанти відповідей із позначкою правильних. Таблиця TestAttempts фіксує спроби проходження тестів користувачами: тест, учень, час початку й завершення, кількість правильних відповідей та підсумковий результат. Деталізація кожної спроби зберігається у таблиці TestAnswers, де для кожного запитання зазначається обраний варіант відповіді та ознака правильності (Див. додаток А.1).
     Для реалізації механізму сповіщень використовується таблиця Notifications, де зберігаються повідомлення для користувачів: тип сповіщення, текст, канал доставки (Email або Push), статус (New, Sent, Read) та час створення. Кожен запис має зовнішній ключ UserId, який пов’язує сповіщення з конкретним користувачем, наприклад для нагадувань про заняття або інформування про результати тестів (Див. додаток А.1).
     Таблиця ProgressMetrics використовується для зберігання агрегованих показників прогресу. Вона може посилатися як на конкретного користувача (UserId), так і на групу (GroupId) і містить період, за який обчислювалися значення, середній бал за тести, відсоток відвідуваності та кількість пропущених занять. Ці дані використовуються для побудови аналітичних звітів і візуалізації динаміки навчання як на рівні окремого учня, так і на рівні груп або всієї автошколи (Див. додаток А.1).


6 РОЗРОБИТИ ФУНКЦІЇ РОБОТИ З БД

6.1 Методи доступу до БД
	Доступ до бази даних у системі HiveTrack здійснюється через окремий шар роботи з даними (Data Access Layer), який інкапсулює всі SQL-запити та операції над таблицями. Це дозволяє відокремити бізнес-логіку від низькорівневої взаємодії з БД та спростити подальшу підтримку й розширення системи. Усі методи доступу до даних реалізуються за допомогою параметризованих SQL-запитів, що гарантує захист від SQL-ін?єкцій та забезпечує коректну роботу з різними типами даних.
	Для кожної основної сутності бази даних передбачено свій набір методів. Наприклад, для таблиці Users реалізуються функції створення нового користувача, пошуку користувача за ідентифікатором або електронною поштою, отримання списку користувачів за роллю, оновлення профілю та зміни статусу активності. Для таблиць Groups та Enrollments передбачені методи створення та редагування навчальних груп, зарахування й відрахування учнів, отримання складу групи та історії навчання конкретного користувача. Усі ці операції виконуються через окремі функції, що повертають об’єкти доменної моделі або колекції записів.
	Робота з навчальним процесом зосереджена в методах, які взаємодіють з таблицями Lessons та Attendance. Передбачені функції для додавання нових занять, отримання розкладу для групи або інструктора, а також запису та перегляду відвідуваності учнів. При фіксації відвідуваності використовуються методи вставки та оновлення записів у таблиці Attendance, що дозволяє як створювати нові записи, так і коригувати статус відвідування або коментар викладача. Для підвищення продуктивності під час формування журналів та звітів використовуються запити з фільтрацією за датою, групою та конкретним учнем.
	Окремий набір методів реалізовано для модуля тестування ПДР. Для таблиць Tests, Questions та AnswerOptions використовуються функції завантаження структури тесту (запитань і варіантів відповідей), а для таблиць TestAttempts та TestAnswers — методи створення нової спроби тесту, збереження відповідей та розрахунку підсумкового результату. Такі функції викликаються під час проходження тесту й формування звітів про успішність. Додаткові методи працюють із таблицями Notifications та ProgressMetrics: вони дозволяють додавати нові сповіщення для користувачів, змінювати їхній статус, а також записувати та зчитувати агреговані показники прогресу за вказаний період. Усі ці методи разом утворюють повноцінний інтерфейс доступу до БД, який використовується серверною частиною HiveTrack для реалізації бізнес-функцій системи.


7 РОЗРОБКА API ДЛЯ СЕРВЕРНОЇ ЧАСТИНИ

7.1 Тип API, що буде використовуватися
	Для взаємодії між клієнтською частиною та сервером використовується REST API. Дані передаються у форматі JSON через стандартні HTTP-методи (GET, POST, PUT, DELETE). Авторизація користувачів здійснюється за допомогою JWT-токенів.
Опис основних контролерів і ендпоінтів:
     AuthController
     Призначення: реєстрація та авторизація користувачів.
     POST /api/auth/register — реєстрація нового користувача (приймає DTO з даними користувача).
     POST /api/auth/login — вхід користувача, повертає JWT-токен.
     UsersController
     Призначення: робота з обліковими записами користувачів (адміністративний функціонал).
     GET /api/users — отримати список користувачів (для адміністратора).
     GET /api/users/{id} — отримати інформацію про конкретного користувача.
     PUT /api/users/{id} — оновити дані користувача (роль, статус, контакти).
     DELETE /api/users/{id} — деактивувати або видалити користувача.
     GroupsController
     Призначення: керування навчальними групами автошколи.
     GET /api/groups — отримати всі групи.
     GET /api/groups/{id} — отримати деталі конкретної групи.
     POST /api/groups — створити нову групу (назва, категорія, дати навчання).
     PUT /api/groups/{id} — оновити дані групи.
     DELETE /api/groups/{id} — видалити групу.
     EnrollmentsController
     Призначення: керування зарахуванням учнів до груп.
     
     GET /api/groups/{groupId}/students — отримати список учнів, зарахованих до групи.
     GET /api/students/{userId}/enrollments — отримати всі групи, в яких навчається або навчався учень.
     POST /api/enrollments — зарахувати учня до групи.
     DELETE /api/enrollments/{id} — відрахувати або завершити зарахування.
     LessonsController
     Призначення: робота із заняттями (теорія та практика).
     	GET /api/lessons/group/{groupId} — отримати розклад занять для групи.
     GET /api/lessons/instructor/{instructorId} — отримати заняття, які веде інструктор.
     GET /api/lessons/{id} — отримати дані конкретного заняття.
     POST /api/lessons — створити нове заняття (тип, тема, дата/час, група, інструктор).
     PUT /api/lessons/{id} — оновити дані заняття.
     DELETE /api/lessons/{id} — видалити заняття.
     TestsController
     Призначення: керування тестами ПДР та структурою запитань.
     GET /api/tests — отримати список доступних тестів.
     GET /api/tests/{id} — отримати деталі тесту (загальна інформація).
     GET /api/tests/{id}/questions — отримати запитання та варіанти відповідей для тесту.
     POST /api/tests — створити новий тест.
     PUT /api/tests/{id} — оновити параметри тесту.
     DELETE /api/tests/{id} — видалити тест.
     TestAttemptsController
     Призначення: фіксація спроб проходження тестів та результатів.
     POST /api/tests/{testId}/attempts — створити нову спробу тесту для поточного учня (початок тестування).
     PUT /api/attempts/{id}/finish — завершити спробу тесту, зберегти результат.
     GET /api/attempts/my — отримати історію своїх спроб тестування.
     GET /api/attempts/student/{studentId} — отримати спроби тестів конкретного учня (для інструктора/адміна).
     GET /api/attempts/{id} — отримати деталі конкретної спроби, включно з відповідями.
     NotificationsController
     Призначення: робота зі сповіщеннями користувачів.
     GET /api/notifications/my — отримати сповіщення поточного користувача.
     PUT /api/notifications/{id}/read — позначити сповіщення як прочитане.
     POST /api/notifications — створити нове сповіщення (для системних або адмін-сповіщень).
     ProgressMetricsController
     Призначення: доступ до агрегованих показників прогресу.
     GET /api/progress/my — отримати зведені показники прогресу поточного учня (середній бал, відвідуваність).
     GET /api/progress/group/{groupId} — отримати метрики прогресу для конкретної групи (для інструктора або адміністратора).
     POST /api/progress/recalculate — перерахувати метрики прогресу за вказаний період (адмін-функція).
     Для передачі даних між клієнтом і сервером використовуються DTO-класи, що визначають структуру запитів і відповідей.Це дозволяє уникнути передачі зайвої інформації (наприклад, внутрішніх технічних полів таблиць), а також забезпечує більшу безпеку та стабільність API при зміні внутрішньої структури бази даних.
     

8 СПЕЦИФІКАЦІЯ РОЗРОБЛЕНОГО API
8.1 Специфікація API системи HiveTrack
     Заняття — LessonsController
GET /api/lessons/group/{groupId}
Опис: Отримання списку занять для вказаної навчальної групи.
     Відповідь:
        {
          "id": 12,
          "groupId": 3,
          "instructorId": 5,
          "type": "Theory",
          "topic": "Правила проїзду перехресть",
          "lessonDateTime": "2025-03-10T18:00:00"
        },
        {
          "id": 13,
          "groupId": 3,
          "instructorId": 5,
          "type": "Practice",
          "topic": "Міський цикл. Рух у заторах",
          "lessonDateTime": "2025-03-12T15:30:00"
      }
GET /api/lessons/{id}
Опис: Отримання детальної інформації про конкретне заняття.
Відповідь:
{
  "id": 12,
  "groupId": 3,
  "instructorId": 5,
  "type": "Theory",
  "topic": "Правила проїзду перехресть",
  "lessonDateTime": "2025-03-10T18:00:00"
}
Якщо заняття не знайдено — відповідь 404 Not Found.
POST /api/lessons
Опис: Додавання нового заняття (теоретичного або практичного).
Тіло запиту:
{
  "groupId": 3,
  "instructorId": 5,
  "type": "Practice",
  "topic": "Паркування та маневрування",
  "lessonDateTime": "2025-03-15T14:00:00"
}
Відповідь:
{
  "id": 20,
  "groupId": 3,
  "instructorId": 5,
  "type": "Practice",
  "topic": "Паркування та маневрування",
  "lessonDateTime": "2025-03-15T14:00:00"
}
У разі некоректних даних — 400 Bad Request.
PUT /api/lessons/{id}
Опис: Оновлення інформації про заняття (зміна теми, дати/часу, типу).
Тіло запиту: 
{
  "groupId": 3,
  "instructorId": 5,
  "type": "Practice",
  "topic": "Паркування: заїзд у бокс",
  "lessonDateTime": "2025-03-15T15:00:00"
}
Відповідь (204 No Content)
(тіло відповіді відсутнє, зміни збережені в БД).

Якщо заняття з таким id не існує — 404 Not Found.
DELETE /api/lessons/{id}
Опис: Видалення заняття з розкладу.
Відповідь (204 No Content)
(запис успішно видалений).
Якщо заняття не знайдено — 404 Not Found.


9 ПЕРЕВІРКА РОБОТИ СТВОРЕННОГО КОДУ

9.1 Тестування розроблених функцій

Рисунок 9.1 – Створити нове заняття  

Рисунок 9.2 – Успішна перевірка працездатності серверу шляхом виклику неправильного запиту 

Рисунок 9.3 – Заняття було успішно створене
 
Рисунок 9.4 – Успішне отримання списку занять для групи

Рисунок 9.5 – Успішне отримання списку груп

Рисунок 9.6 – Успішне створення нової групи

Рисунок 9.7 – Успішне створення запису відвідуваності

Рисунок 9.8 – Успішне отримання відвідуваності для заняття

Рисунок 9.9 – Успішне отримання історії відвідуваності студента



Додаток А
А.1 Код таблиць бази даних:
  Таблиця користувачів
CREATE TABLE users (
    id             INT AUTO_INCREMENT PRIMARY KEY,
    full_name      VARCHAR(200) NOT NULL,
    email          VARCHAR(200) NOT NULL UNIQUE,
    phone          VARCHAR(30),
    role           ENUM('Student','Instructor','Admin') NOT NULL DEFAULT 'Student',
    password_hash  VARCHAR(255) NOT NULL,
    is_active      TINYINT(1) NOT NULL DEFAULT 1,
    created_at     DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP
) ENGINE=InnoDB;
  Навчальні групи
CREATE TABLE groups (
    id             INT AUTO_INCREMENT PRIMARY KEY,
    name           VARCHAR(200) NOT NULL,
    category       VARCHAR(20)  NOT NULL,
    start_date     DATE         NOT NULL,
    end_date       DATE         NULL
) ENGINE=InnoDB;
  Зарахування до груп
CREATE TABLE enrollments (
    id             INT AUTO_INCREMENT PRIMARY KEY,
    user_id        INT NOT NULL,
    group_id       INT NOT NULL,
    enrolled_at    DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    status         VARCHAR(50) NOT NULL DEFAULT 'Active',
    CONSTRAINT fk_enroll_user
        FOREIGN KEY (user_id) REFERENCES users(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_enroll_group
        FOREIGN KEY (group_id) REFERENCES groups(id)
        ON DELETE CASCADE
) ENGINE=InnoDB;

CREATE INDEX idx_enroll_user  ON enrollments(user_id);
CREATE INDEX idx_enroll_group ON enrollments(group_id);
  Заняття
CREATE TABLE lessons (
    id              INT AUTO_INCREMENT PRIMARY KEY,
    group_id        INT NOT NULL,
    instructor_id   INT NOT NULL,
    type            ENUM('Theory','Practice') NOT NULL,
    topic           VARCHAR(255) NOT NULL,
    lesson_datetime DATETIME NOT NULL,
    CONSTRAINT fk_lessons_group
        FOREIGN KEY (group_id) REFERENCES groups(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_lessons_instructor
        FOREIGN KEY (instructor_id) REFERENCES users(id)
        ON DELETE RESTRICT
) ENGINE=InnoDB;

CREATE INDEX idx_lessons_group      ON lessons(group_id);
CREATE INDEX idx_lessons_instructor ON lessons(instructor_id);
CREATE INDEX idx_lessons_datetime   ON lessons(lesson_datetime);
  Відвідуваність
CREATE TABLE attendance (
    id          INT AUTO_INCREMENT PRIMARY KEY,
    lesson_id   INT NOT NULL,
    student_id  INT NOT NULL,
    status      ENUM('Present','Absent','Late') NOT NULL,
    comment     VARCHAR(500),
    CONSTRAINT fk_att_lesson
        FOREIGN KEY (lesson_id) REFERENCES lessons(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_att_student
        FOREIGN KEY (student_id) REFERENCES users(id)
        ON DELETE CASCADE
) ENGINE=InnoDB;

CREATE INDEX idx_att_lesson  ON attendance(lesson_id);
CREATE INDEX idx_att_student ON attendance(student_id);
  Тести
CREATE TABLE tests (
    id                 INT AUTO_INCREMENT PRIMARY KEY,
    name               VARCHAR(200) NOT NULL,
    mode               ENUM('Training','Exam') NOT NULL,
    time_limit_minutes INT NOT NULL
) ENGINE=InnoDB;
  Питання тестів
CREATE TABLE questions (
    id          INT AUTO_INCREMENT PRIMARY KEY,
    test_id     INT NOT NULL,
    text        TEXT NOT NULL,
    topic       VARCHAR(100),
    difficulty  TINYINT,
    CONSTRAINT fk_questions_test
        FOREIGN KEY (test_id) REFERENCES tests(id)
        ON DELETE CASCADE
) ENGINE=InnoDB;

CREATE INDEX idx_questions_test ON questions(test_id);
  Варіанти відповідей
CREATE TABLE answer_options (
    id           INT AUTO_INCREMENT PRIMARY KEY,
    question_id  INT NOT NULL,
    text         TEXT NOT NULL,
    is_correct   TINYINT(1) NOT NULL DEFAULT 0,
    CONSTRAINT fk_ansopts_question
        FOREIGN KEY (question_id) REFERENCES questions(id)
        ON DELETE CASCADE
) ENGINE=InnoDB;

CREATE INDEX idx_ansopts_question ON answer_options(question_id);
Спроби тесту
CREATE TABLE test_attempts (
    id            INT AUTO_INCREMENT PRIMARY KEY,
    test_id       INT NOT NULL,
    student_id    INT NOT NULL,
    started_at    DATETIME NOT NULL,
    finished_at   DATETIME,
    correct_count INT NOT NULL DEFAULT 0,
    score         INT NOT NULL DEFAULT 0,
    CONSTRAINT fk_attempts_test
        FOREIGN KEY (test_id) REFERENCES tests(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_attempts_student
        FOREIGN KEY (student_id) REFERENCES users(id)
        ON DELETE CASCADE
) ENGINE=InnoDB;

CREATE INDEX idx_attempts_test    ON test_attempts(test_id);
CREATE INDEX idx_attempts_student ON test_attempts(student_id);
Відповіді в межах спроби
CREATE TABLE test_answers (
    id               INT AUTO_INCREMENT PRIMARY KEY,
    attempt_id       INT NOT NULL,
    question_id      INT NOT NULL,
    answer_option_id INT NOT NULL,
    is_correct       TINYINT(1) NOT NULL,
    CONSTRAINT fk_tans_attempt
        FOREIGN KEY (attempt_id) REFERENCES test_attempts(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_tans_question
        FOREIGN KEY (question_id) REFERENCES questions(id)
        ON DELETE CASCADE,
    CONSTRAINT fk_tans_ansopt
        FOREIGN KEY (answer_option_id) REFERENCES answer_options(id)
        ON DELETE CASCADE
) ENGINE=InnoDB;
CREATE INDEX idx_tans_attempt  ON test_answers(attempt_id);
CREATE INDEX idx_tans_question ON test_answers(question_id);
Сповіщення
CREATE TABLE notifications (
    id          INT AUTO_INCREMENT PRIMARY KEY,
    user_id     INT NOT NULL,
    type        VARCHAR(50) NOT NULL,
    message     VARCHAR(500) NOT NULL,
    channel     ENUM('Email','Push') NOT NULL,
    status      ENUM('New','Sent','Read') NOT NULL DEFAULT 'New',
    created_at  DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    CONSTRAINT fk_notif_user
        FOREIGN KEY (user_id) REFERENCES users(id)
        ON DELETE CASCADE
) ENGINE=InnoDB;

CREATE INDEX idx_notif_user ON notifications(user_id);
Метрики прогресу
CREATE TABLE progress_metrics (
    id             INT AUTO_INCREMENT PRIMARY KEY,
    user_id        INT NULL,
    group_id       INT NULL,
    period_from    DATETIME NOT NULL,
    period_to      DATETIME NOT NULL,
    avg_test_score INT,
    attendance_rate INT,
    missed_lessons INT,
    CONSTRAINT fk_pmetric_user
        FOREIGN KEY (user_id) REFERENCES users(id)
        ON DELETE SET NULL,
    CONSTRAINT fk_pmetric_group
        FOREIGN KEY (group_id) REFERENCES groups(id)
        ON DELETE SET NULL
) ENGINE=InnoDB;

CREATE INDEX idx_pmetric_user  ON progress_metrics(user_id);
CREATE INDEX idx_pmetric_group ON progress_metrics(group_id);

ДОДАТОК Б
Посилання на код
https://github.com/NureTavdhiridzeDavyd/ark-pzpi-23-7-tavdhiridze-davyd



ДОДАТОК В
Посилання на відео
https://youtu.be/xCTgZoXYvTA
